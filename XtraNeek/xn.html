<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>XtraNeek - Streamtape Demo</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  <style>
    body { background:#0b0b0b; color:#fff; font-family:sans-serif; margin:0; }
    header, footer { background:#111; padding:1rem; text-align:center; }
    .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:1rem; padding:1rem; }
    .card { background:#1a1a1a; border-radius:12px; padding:1rem; text-align:center; cursor:pointer; transition:.3s; }
    .card:hover { transform:scale(1.03); }
    .poster { width:100%; border-radius:8px; }
    .title { margin-top:.5rem; font-weight:bold; font-size:.9rem; }
    .meta { font-size:.8rem; color:#bbb; }
    /* Modal */
    .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:9999; align-items:center; justify-content:center; }
    .modal-content { background:#111; padding:1rem; border-radius:12px; max-width:900px; width:90%; max-height:90vh; overflow:auto; }
    iframe { width:100%; height:500px; border:none; border-radius:8px; }
    .close-btn { float:right; font-size:20px; cursor:pointer; color:#fff; }
  </style>
</head>
<body>
  <header>
    <h1>XtraNeek Streamtape Demo</h1>
    <input id="searchBox" placeholder="Search clips..." style="padding:.5rem;width:250px;border-radius:8px;border:1px solid #444;background:#1a1a1a;color:#fff"/>
    <button id="searchBtn">Search</button>
  </header>

  <main>
    <div id="results" class="grid"></div>
  </main>

  <footer>© 2025 XtraNeek</footer>

  <!-- Modal -->
  <div id="playerModal" class="modal">
    <div class="modal-content">
      <span id="closeModal" class="close-btn">&times;</span>
      <h3 id="modalTitle"></h3>
      <iframe id="videoFrame" src="" allowfullscreen></iframe>
    </div>
  </div>

  <script>
    const login = "e7ee4fadf810fd1c648e";  // ⚠️ visible key
    const key   = "1jZwwG0Gkxsev3J";        // ⚠️ visible key

    const resultsEl = document.getElementById("results");
    const modal = document.getElementById("playerModal");
    const videoFrame = document.getElementById("videoFrame");
    const modalTitle = document.getElementById("modalTitle");
    const closeModal = document.getElementById("closeModal");

    async function loadFolder(folder="0") {
      const url = \`https://api.streamtape.com/file/listfolder?login=\${login}&key=\${key}&folder=\${folder}\`;
      const r = await fetch(url);
      const json = await r.json();
      resultsEl.innerHTML = "";
      if (json.status !== 200) {
        resultsEl.innerHTML = "<p>Error loading files.</p>";
        return;
      }
      (json.result?.files || []).forEach(file => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = \`
          <img class="poster" src="https://github.com/animeneek/Neek/blob/main/assets/images/Poster%20404%20Error.png?raw=true"/>
          <div class="title">\${file.name}</div>
          <div class="meta">Size: \${(file.size/1048576).toFixed(1)} MB</div>
        \`;
        div.onclick = () => openModal(file);
        resultsEl.appendChild(div);
      });
    }

    function openModal(file) {
      modal.style.display = "flex";
      modalTitle.textContent = file.name;
      videoFrame.src = \`https://streamtape.com/e/\${file.linkid}\`;
    }

    closeModal.onclick = () => {
      modal.style.display = "none";
      videoFrame.src = "";
    };

    window.onclick = (e) => {
      if (e.target === modal) {
        modal.style.display = "none";
        videoFrame.src = "";
      }
    };

    // Search box (just a redirect for now)
    document.getElementById("searchBtn").onclick = () => {
      const val = document.getElementById("searchBox").value.trim();
      if (val) alert("Search not wired yet: " + val);
    };

    // Initial load
    loadFolder("0");
  </script>
</body>
</html>
